
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Analysis Framework &#8212; FUNtoFEM .0 documentation</title>
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="FUNtoFEM Model" href="model.html" />
    <link rel="prev" title="Welcome to FUNtoFEM’s Documentation" href="index.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="model.html" title="FUNtoFEM Model"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to FUNtoFEM’s Documentation"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">FUNtoFEM .0 documentation</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Analysis Framework</a><ul>
<li><a class="reference internal" href="#aerothermal-framework">Aerothermal Framework</a><ul>
<li><a class="reference internal" href="#aerothermal-adjoint">Aerothermal Adjoint</a></li>
</ul>
</li>
<li><a class="reference internal" href="#aerothermoelastic-framework">Aerothermoelastic Framework</a><ul>
<li><a class="reference internal" href="#aerothermoelastic-adjoint">Aerothermoelastic Adjoint</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Welcome to FUNtoFEM’s Documentation</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="model.html"
                        title="next chapter">FUNtoFEM Model</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="analysis-framework">
<h1>Analysis Framework<a class="headerlink" href="#analysis-framework" title="Permalink to this headline">¶</a></h1>
<div class="section" id="aerothermal-framework">
<h2>Aerothermal Framework<a class="headerlink" href="#aerothermal-framework" title="Permalink to this headline">¶</a></h2>
<div class="figure">
<img alt="_images/aerothermal_framework.png" src="_images/aerothermal_framework.png" />
</div>
<p>The residuals for the aerodynamic governing equations are obtained using a discrete approximation of the following integral over each finite volume</p>
<div class="math notranslate nohighlight">
\[{A}\left({x}, {q}, {\dot{q}}, {x}_G, {\dot{x}}_G, {t}_{A}, t\right) \triangleq \dfrac{\partial \left( V {q} \right)} {\partial t} + \oint_{\partial V} \left( {\overline{\overline{F}}}^* - {\overline{\overline{F}}_v} \right) \cdot { \hat{n}} dS = 0\]</div>
<p>An interface has been added to FUN3D for aerothermoelastic analysis using the FUNtoFEM framework. This interface provides routines for both force and heat flux integration, as well as the terms needed for the adjoint equations. Furthermore, the interface adds the required multidisciplinary components to the right-hand-side of the aerodynamic adjoint equations. The force integration is a function of the aerodynamic state variables and the node locations and constitutes a system of residuals written as</p>
<div class="math notranslate nohighlight">
\[{F} \left( {x}, {x}_G, {q}, {f}_A \right) \triangleq {\phi} \left( {x}, {x}_G, {q} \right) - {f}_A = 0\]</div>
<p>The heat flux integration is also a function of the aerodynamic state variables and node locations and is written as</p>
<div class="math notranslate nohighlight">
\[{H} \left( {x}, {x}_G, {q}, {f}_{T,A} \right) \triangleq {\varphi} \left( {x}, {x}_G, {q} \right) - {f}_{T,A} = 0\]</div>
<div class="section" id="aerothermal-adjoint">
<h3>Aerothermal Adjoint<a class="headerlink" href="#aerothermal-adjoint" title="Permalink to this headline">¶</a></h3>
<p>The Lagrangian for the aerothermal problem is formed by summing the function of interest with the products of the residuals for each analysis component combined with their corresponding adjoint, giving the following expression</p>
<div class="math notranslate nohighlight">
\[\begin{split}    \mathbf{\mathcal{L}}_{AT} \triangleq \; &amp; f(\mathbf{x},\mathbf{q},\mathbf{t}_{A},\mathbf{f}_{T,A},\mathbf{f}_{T,S},\mathbf{t}_{S})
+ \mathbf{\psi}_{A}^{T} \mathbf{A}(\mathbf{x},\mathbf{q},{t}_{A})
+ \mathbf{\psi}_{H}^{T} \mathbf{H}(\mathbf{x},\mathbf{t}_{A},\mathbf{q},\mathbf{f}_{T,A})
+ \mathbf{\psi}_{Q}^{T} \mathbf{Q}(\mathbf{f}_{T,A},\mathbf{f}_{T,S})\\
&amp; + \mathbf{\psi}_{T,S}^{T} \mathbf{S}(\mathbf{x},\mathbf{t}_{S},\mathbf{f}_{T,S})
+ \mathbf{\psi}_{T}^{T} \mathbf{T}(\mathbf{t}_{S},{t}_{A})\end{split}\]</div>
<p>The adjoint equations are obtained by taking the derivative of the Lagrangian with respect to the state variables and setting it to zero. This results in the following coupled system of equations</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
\frac{\partial \mathbf{A}}{\partial \mathbf{q}}^{T} &amp;
\frac{\partial \mathbf{H}}{\partial \mathbf{q}}^{T} &amp; 0 &amp; 0 &amp; 0\\
%
0 &amp; \frac{\partial \mathbf{H}}{\partial \mathbf{f}_{T,A}}^{T} &amp;
\frac{\partial \mathbf{Q}}{\partial \mathbf{f}_{T,A}}^{T} &amp; 0 &amp; 0 \\
%
0 &amp; 0 &amp; \frac{\partial \mathbf{Q}}{\partial \mathbf{f}_{T,S}}^{T} &amp;
\frac{\partial \mathbf{S}}{\partial \mathbf{f}_{T,S}}^{T} &amp; 0 \\
%
0 &amp; 0 &amp; 0 &amp; \frac{\partial \mathbf{S}}{\partial \mathbf{t}_{S}}^{T} &amp;
\frac{\partial \mathbf{T}}{\partial \mathbf{t}_{S}}^{T} \\
%
\frac{\partial \mathbf{A}}{\partial \mathbf{t}_{A}}^{T} &amp; 0 &amp; 0 &amp; 0 &amp;
\frac{\partial \mathbf{T}}{\partial \mathbf{t}_{A}}^{T} \\
%
\end{bmatrix}
\begin{bmatrix}
\mathbf{\psi}_{A} \\
\mathbf{\psi}_{H} \\
\mathbf{\psi}_{Q} \\
\mathbf{\psi}_{T,S} \\
\mathbf{\psi}_{T}
\end{bmatrix}
= -
\begin{bmatrix}
\frac{\partial f}{\partial \mathbf{q}}^{T} \\
\frac{\partial f}{\partial \mathbf{f}_{T,A}}^{T} \\
\frac{\partial f}{\partial \mathbf{f}_{T,S}}^{T} \\
\frac{\partial f}{\partial \mathbf{t}_{S}}^{T} \\
\frac{\partial f}{\partial \mathbf{t}_{A}}^{T} \\
\end{bmatrix}\end{split}\]</div>
</div>
</div>
<div class="section" id="aerothermoelastic-framework">
<h2>Aerothermoelastic Framework<a class="headerlink" href="#aerothermoelastic-framework" title="Permalink to this headline">¶</a></h2>
<div class="figure">
<img alt="_images/aerothermoelastic_framework.png" src="_images/aerothermoelastic_framework.png" />
</div>
<p>The surface displacements are computed by solving the displacement transfer residuals and preserving rigid-body motion. The displacement transfer scheme is given by:</p>
<div class="math notranslate nohighlight">
\[{D}({x}, {u}_{S}, {u}_{A}) \triangleq {\xi}({x}, {u}_{S}) - {u}_{A} = 0\]</div>
<p>To obtain a consistent and conservative load transfer, the load transfer is derived based on the method of virtual work. The residual of the load transfer scheme is:</p>
<div class="math notranslate nohighlight">
\[{L}({x}, {u}_{S}, {f}_{A}, {f}_{S}) \triangleq {\eta}({x}, {u}_{S}, {f}_{A}) - {f}_{S} = 0\]</div>
<p>MELDThermal links each aerodynamic surface node, where a wall temperature will be specified, to a fixed number of the nearest structural nodes from which the structural temperature will be interpolated. This approach is analogous to the localization property of MELD such that each aerodynamic surface node receives temperature information from a limited number of structural nodes. The temperature of the aerodynamic surface node is then computed from the temperatures of the set of linked structural nodes:</p>
<div class="math notranslate nohighlight">
\[T_{A} = \sum_{i=1}^{N} w_{i} {T_{S}}_{i}\]</div>
<p>The weights are computed based on the Euclidean distance between the aerodynamic node and the corresponding structural surface nodes:</p>
<div class="math notranslate nohighlight">
\[w_{i} = e^{- \beta d_{i}^2}  \Bigg/ \sum_{j=1}^{N} e^{- \beta d_{j}^2}\]</div>
<p>The interpolation is repeated for all aerodynamic surface nodes, giving the temperature transfer residual:</p>
<div class="math notranslate nohighlight">
\[{T}({t}_{S}, {t}_{A}) \triangleq  {W} {t}_{S} - {t}_{A} = 0,\]</div>
<p>The relationship between the area-weighted heat flux at the aerodynamic surface nodes and the resulting heat flux on the structural nodes is calculated in the same manner as the loads. Based on virtual work, the flux produced at a structural node by the force at an aerodynamic surface node is:</p>
<div class="math notranslate nohighlight">
\[{Q}({f}_{T,A}, {f}_{T,S}) \triangleq {W}^{T} {f}_{T,A} - {f}_{T,S} = 0\]</div>
<div class="section" id="aerothermoelastic-adjoint">
<h3>Aerothermoelastic Adjoint<a class="headerlink" href="#aerothermoelastic-adjoint" title="Permalink to this headline">¶</a></h3>
<p>The aerothermoelastic adjoint equations are derived to be discretely consistent with the forward governing equations. The Lagrangian for the aerothermoelastic problem is formed by summing the function of interest with the products of the residuals for each analysis component combined with their corresponding adjoint, giving the following expression</p>
<div class="math notranslate nohighlight">
\[\begin{split}    \mathbf{\mathcal{L}}_{ATE} \triangleq \; &amp; f({x}, {q}, {x}_{G}, {f}_{A}, {f}_{S}, {f}_{T,A}, {f}_{T,S}, {u}_{S}, {t}_{S}, {u}_{A}, {t}_{A})
+ \psi_{A}^{T} {A}({x}, {q}, {x}_G, {t}_{A} )
+ \psi_{G}^{T} {G}\left({x}, {u}_{A}, {x}_G\right) \\
&amp; + \psi_{F}^{T} {F} ( {x}, {x}_G, {q}, {f}_A )
+ \psi_{L}^{T} {L}({x}, {u}_{S}, {f}_{A}, {f}_{S})
+ \psi_{H}^{T} {H} \left( {x}, {x}_G, {q}, {f}_{T,A} \right)
+ \psi_{Q}^{T} \mathbf{Q}(\mathbf{f}_{T,A},\mathbf{f}_{T,S}) \\
&amp; + \psi_{S}^{T} \mathbf{S}(\mathbf{x},{u}_{S},\mathbf{t}_{S},{f}_{S},\mathbf{f}_{T,S})
+ \psi_{D}^{T} {D}({x}, {u}_{S}, {u}_{A})
+ \psi_{T}^{T} \mathbf{T}(\mathbf{t}_{S},{t}_{A})\end{split}\]</div>
<p>The adjoint equations are obtained by taking the derivative of the aerothermoelastic Lagrangian with respect to the state variables and setting it to zero. This results in the following coupled system of equations</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
\frac{\partial \mathbf{A}}{\partial \mathbf{q}}^{T} &amp; 0 &amp;
\frac{\partial {F}}{\partial {q}}^{T} &amp; 0 &amp;
\frac{\partial \mathbf{H}}{\partial \mathbf{q}}^{T} &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
%
\frac{\partial {A}}{\partial {x}_{G}}^{T} &amp;
\frac{\partial {G}}{\partial {x}_{G}}^{T} &amp;
\frac{\partial {F}}{\partial {x}_{G}}^{T} &amp; 0 &amp;
\frac{\partial {H}}{\partial {x}_{G}}^{T} &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
%
0 &amp; 0 &amp; \frac{\partial {F}}{\partial {f}_{A}}^{T} &amp;
\frac{\partial {L}}{\partial {f}_{A}}^{T} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
%
0 &amp; 0 &amp; 0 &amp; \frac{\partial {L}}{\partial {f}_{S}}^{T} &amp;
0 &amp; 0 &amp; \frac{\partial {S}}{\partial {f}_{S}}^{T} &amp; 0 &amp; 0 \\
%
0 &amp; 0 &amp; 0 &amp; 0 &amp; \frac{\partial {H}}{\partial {f}_{T,A}}^{T} &amp;
\frac{\partial {Q}}{\partial {f}_{T,A}}^{T} &amp; 0 &amp; 0 &amp; 0 \\
%
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \frac{\partial {Q}}{\partial {f}_{T,S}}^{T} &amp;
\frac{\partial {S}}{\partial {f}_{T,S}}^{T} &amp; 0 &amp; 0 \\
%
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp;
\frac{\partial {S}}{\partial {u}_{S}}^{T} &amp;
\frac{\partial {D}}{\partial {u}_{S}}^{T} &amp;
\frac{\partial {S}}{\partial {t}_{S}}^{T} \\
%
0 &amp; \frac{\partial {G}}{\partial {u}_{A}}^{T} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp;
\frac{\partial {D}}{\partial {u}_{A}}^{T} &amp; 0 \\
%
\frac{\partial {A}}{\partial {t}_{A}}^{T} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp;
\frac{\partial {T}}{\partial {t}_{A}}^{T}
\end{bmatrix}
\begin{bmatrix}
\psi_{A} \\
\psi_{G} \\
\psi_{F} \\
\psi_{L} \\
\psi_{H} \\
\psi_{Q} \\
\psi_{S} \\
\psi_{D} \\
\psi_{T} \\
\end{bmatrix}
= -
\begin{bmatrix}
\frac{\partial f}{\partial \mathbf{q}}^{T} \\
\frac{\partial f}{\partial {x}_{G}}^{T} \\
\frac{\partial f}{\partial {f}_{A}}^{T} \\
\frac{\partial f}{\partial {f}_{S}}^{T} \\
\frac{\partial f}{\partial {f}_{T,A}}^{T} \\
\frac{\partial f}{\partial {f}_{T,S}}^{T} \\
\frac{\partial f}{\partial {u}} \\
\frac{\partial f}{\partial {u}_{A}} \\
\frac{\partial f}{\partial {t}_{A}}
\end{bmatrix}\end{split}\]</div>
<p>Once the solution for the adjoint equations has been obtained, the total derivative for the function of interest is computed as the derivative of the Lagrangian</p>
<div class="math notranslate nohighlight">
\[\nabla_{{x}}f \triangleq \frac{\partial \mathcal{L}_{ATE}}{\partial {x}}\]</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="model.html" title="FUNtoFEM Model"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to FUNtoFEM’s Documentation"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">FUNtoFEM .0 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, FUNtoFEM Developers.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
  </body>
</html>